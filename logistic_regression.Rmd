---
title: "20200402_Lu_Junlan_HW4"
output: html_document
---


---
title: "Linear regression"
output:
  html_document: default
---
Junlan Lu
NetID: jl909
## Data Preparation
1) 
```{r}
#import the file into R with the labeled column
df <- read.table("features_1.csv",header= TRUE,sep = ",")
head(df,10) #prints the first few lines of the dataframe including header row
```


```{r}
# splits into test and train
library(caTools)
set.seed(123)
df =  subset(df, select= -c(X,X0))
sample = sample.split(df,SplitRatio = .8)
train.set = subset(df, sample == TRUE)
test.set = subset(df, sample == FALSE)
```

```{r}
library(glmulti)
glmulti.logistic.out <-
    glmulti(X0.2 ~  X13 + X15 + X17 + X18 + X19 + X21 + X20 + X21 + X23 + X2 + X3 +X4 + X5 +X6 +X7 +X8, data = train.set,
            level = 1,               # No interaction considered
            method = "h",            # Exhaustive approach
            crit = "aic",            # AIC as criteria
            confsetsize = 5,         # Keep 5 best models
            plotty = F, report = F,  # No plot or interim reports
            fitfunction = "glm",     # glm function
            family = binomial)       # binomial family for logistic regression

## Show 5 best models (Use @ instead of $ for an S4 object)
glmulti.logistic.out@formulas
```

```{r}
summary(glmulti.logistic.out@objects[[1]])
```

```{r}
library(gmodels)
## Show result for the best model
prediction = predict(glmulti.logistic.out@objects[[1]],test.set) > 0
y.test = test.set$X0.2 == "NSIP"

#calculate cross table
crosstable_output = CrossTable(prediction, y.test, prop.chisq=FALSE )

accuracy = (crosstable_output$t[1]+crosstable_output$t[4])/sum(crosstable_output$t) #accuracy = TP+TN/Total
sensitivity = (crosstable_output$t[1])/(crosstable_output$t[1]+crosstable_output$t[2]) #sensitivity = TP/TP+FN
precision = (crosstable_output$t[1])/(crosstable_output$t[1]+crosstable_output$t[3]) #precision = TP/TP+FP
errorrate = (crosstable_output$t[2]+crosstable_output$t[3])/sum(crosstable_output$t) #error rate = FP+FN/Total

print(paste("the accuracy is ",accuracy))
print(paste("the sensitivity is ", sensitivity))
print(paste("the precision is ",precision))
print(paste("the error rate is ",errorrate))
```

